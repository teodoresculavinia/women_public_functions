---
title: "gather"
author: "Lavinia Teodorescu"
date: "10/17/2020"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytext)
library(readr)
library(readxl)
library(stringr)
```



```{r}



recent_ILO_LFP <- read_csv("raw_data/recent-ILO-LFP.csv")
View(recent_ILO_LFP)

saveRDS(recent_ILO_LFP, file = "shiny-app/data/ILO_LFP.rds")

x <- readRDS(file = "shiny-app/data/ILO_LFP.rds")

idea_export_35_5f8a138aec279 <- read_csv("raw_data/idea_export_35_5f8a138aec279.csv")
View(idea_export_35_5f8a138aec279)

saveRDS(idea_export_35_5f8a138aec279, file = "shiny-app/data/political_structure_country.rds")

y <- readRDS(file = "shiny-app/data/political_structure_country.rds")

x %>%
  rename("female_labor" = `Labor force participation rate, female (% of female population ages 15+) (modeled ILO estimate)`) %>%
  
  # The initial column title is to long and I can't seem to be able to put it on
  # two lines because rename() stops working.
  
  group_by(Entity) %>%
  summarize(avg = mean(female_labor), .groups = "drop") %>%
  filter(str_detect(Entity, "^B")) %>%
  
  # This filters the Entity column to find all names that start with a capital
  # B. str_detect is part of the stringr package.
  
ggplot(mapping = aes(x = reorder_within(Entity, within = avg, by = avg), y = avg)) +
  geom_point() +
  scale_x_reordered() +
    theme_linedraw() +
    theme(panel.grid.major = element_line(color = "lightgrey"),
        panel.grid.minor = element_line(color = "lightgrey"),
        panel.background = element_rect(fill = "white"),
        panel.border = element_rect(color = "grey", fill = NA)) +
    theme(axis.text.x = element_text(angle=30)) +
     labs(title = "Women in the Workforce: By country (letter B)", 
          x = "Countries", 
          y = "Percentage of Women in the Workforce", 
          caption = "\n  \n Source: Inter-Parliamentary Union") 

# This is a combination of themes that I did in the past and really enjoyed, so
# decided to copy it here as well. reorder_withing and scale_x_reorder helped me
# reorger values n the x axis based on the values on the y axis.




```



```{r}
women_in_parliament_2008 <- read_excel("raw_data/cpdsIIc/Women in Parliament UPDATED 2008.xls")
  View(women_in_parliament_2008)
  
CPDS_1960_2018 <- read_excel("raw_data/CPDS_1960-2018_Update_2020.xlsx")
View(CPDS_1960_2018)


CPDS_1960_2018

post_comm_list <- read_excel("raw_data/cpdsIIc/Women in Parliament UPDATED 2008.xls") %>%
  mutate(post_comm = "TRUE") %>%
  select(country, post_comm) %>%
  distinct() %>%
right_join(CPDS_1960_2018, by = "country") %>%
  mutate(post_comm = ifelse(is.na(post_comm), FALSE, TRUE))
  
  saveRDS(post_comm_list, file = "shiny-app/data/post_comm_list.rds")
```


```{r}
post_comm_list %>%
  rename("year" = 'year...1') %>%
  filter(year == 2018) %>%
  ggplot(aes(x = reorder_within(country, womenpar, womenpar), y = womenpar, color = post_comm)) +
  geom_point() +
  facet_wrap(~post_comm, drop = TRUE, scales = "free_x") +
  scale_x_reordered() +
    theme_linedraw() +
    theme(panel.grid.major = element_line(color = "lightgrey"),
        panel.grid.minor = element_line(color = "lightgrey"),
        panel.background = element_rect(fill = "white"),
        panel.border = element_rect(color = "grey", fill = NA)) +
  scale_color_discrete(name = "Communist Status", 
                       labels = c("Never Communist", "Post-Communist"))+
    labs(title = "Women in Parliament: Never Communist v. Post- Communist Countries", 
          x = "OECD Countries", 
          y = "Percentage of Women in Parliament", 
          caption = "\n  \n Source: CPDS") +
    theme(axis.text.x = element_text(angle=30))

```

